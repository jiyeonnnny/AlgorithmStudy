```py
def bfs():
    global k
    q = deque([[0,0,0]])
    visited[0][0][0] = 1
    while q:
        v = q.popleft()
        depth, x, y = v[0], v[1], v[2]
        if x==n-1 and y==m-1:
            return
        for dx, dy in [[0,1],[0,-1],[1,0],[-1,0]]:
            nx = x + dx
            ny = y + dy
            if 0<=nx<n and 0<=ny<m:
                if arr[nx][ny]==0 and visited[depth][nx][ny]==0:
                    visited[depth][nx][ny] = visited[depth][x][y] + 1
                    q.append([depth,nx,ny])
                elif arr[nx][ny]==1 and depth < k  and visited[depth+1][nx][ny]==0:
                    visited[depth+1][nx][ny] = visited[depth][x][y] + 1
                    q.append([depth+1, nx, ny])
    return

n, m, k = map(int, input().split())
arr = [list(map(int, input().strip())) for _ in range(n)]
visited = [[[0]*m for _ in range(n)] for _ in range(k+1)]
bfs()
ans = 1000000
for K in range(k+1):
    if visited[K][n-1][m-1]!=0:
        ans = min(ans, visited[K][n-1][m-1])
if ans == 1000000:
    print(-1)
else:
    print(ans)
```
[시간초과]
- 원인:
- 수정 방향성:
